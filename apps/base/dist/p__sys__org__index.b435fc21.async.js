"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[977],{92100:function($,E){var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"};E.Z=e},5842:function($,E,e){var D=e(86378),t=e.n(D),W=e(58357),o=e.n(W),T=e(71977),v=e.n(T),A=e(28488),s=e.n(A),d=e(50959),_=e(15663),M=e(26161),h=e(53801),c=e(11527),L=["propCode","onChange"],Z=function(i){var S=i.propCode,P=i.onChange,O=s()(i,L),I=(0,h.Z)(_.fQ,{manual:!0,cacheKey:"STATIC_".concat(S),staleTime:3e5}),C=I.runAsync,j=function(r){P&&P(r.target.value)};return(0,c.jsx)(M.Z,t()(t()({request:v()(o()().mark(function g(){var r;return o()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,C({query:{propCode:S,state:1},pageNo:1,pageSize:999});case 2:return r=R.sent,R.abrupt("return",r.data.result.map(function(F){return{label:F.valueName,value:+F.valueCode}}));case 4:case"end":return R.stop()}},g)}))},O),{},{radioProps:t()({onChange:j},O==null?void 0:O.radioProps)}))};E.Z=Z},26253:function($,E,e){var D=e(86378),t=e.n(D),W=e(30577),o=e.n(W),T=e(28488),v=e.n(T),A=e(12632),s=e(50959),d=e(53690),_=e(11527),M=["auth","children"],h=function(L){var Z=L.auth,U=L.children,i=v()(L,M),S=(0,d.useModel)("@@initialState"),P=S.initialState,O=P,I=O.currentUser,C=(0,s.useState)(function(){var r;return Z!==void 0?!!(I!=null&&I.authButton&&(r=I.authButton)!==null&&r!==void 0&&r.has(Z)):!0}),j=o()(C,1),g=j[0];return(0,_.jsx)(_.Fragment,{children:g?(0,_.jsx)(A.ZP,t()(t()({},i),{},{children:U})):(0,_.jsx)(_.Fragment,{})})};E.Z=h},4643:function($,E,e){var D=e(58357),t=e.n(D),W=e(86378),o=e.n(W),T=e(71977),v=e.n(T),A=e(30577),s=e.n(A),d=e(28488),_=e.n(d),M=e(40039),h=e(50959),c=e(53690),L=e(93789),Z=e(13655),U=e(5061),i=e(11527),S=["auth","table"],P=L.Z.Text,O=function(C){var j,g=C.auth,r=C.table,z=_()(C,S),R=(0,c.useModel)("@@initialState"),F=R.initialState,n=F,K=n.currentUser,le=(0,h.useState)(function(){var u;return g!==void 0?!!(K!=null&&K.authButton&&(u=K.authButton)!==null&&u!==void 0&&u.has(g)):!0}),_e=s()(le,1),re=_e[0];return(0,i.jsx)(i.Fragment,{children:re?(0,i.jsx)(M.Z,o()(o()({tableLayout:"auto",size:"middle",rowKey:(r==null?void 0:r.rowKey)||z.rowKey,request:function(){var u=v()(t()().mark(function H(p){var N,V,de,G,ne,ae,B,l,a;return t()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return N=p.pageSize,V=p.current,de=p.formValues,G=o()(o()({},de),r==null?void 0:r.requestParam),r!=null&&r.onSearchBefore&&(G=r.onSearchBefore(G)),m.next=5,r==null?void 0:r.request({pageNo:V,pageSize:N,query:G});case 5:if(ne=m.sent,ae=ne.success,B=ne.data,l=B.result,a=B.totalNum,!(r!=null&&r.onSearchAfter)){m.next=12;break}return m.abrupt("return",r==null?void 0:r.onSearchAfter({total:a,success:ae,data:l}));case 12:return m.abrupt("return",{total:a,success:ae,data:l});case 13:case"end":return m.stop()}},H)}));return function(H){return u.apply(this,arguments)}}()},z),{},{columns:(j=z.columns)===null||j===void 0?void 0:j.map(function(u){return u.ellipsis?o()(o()({},u),{},{render:function(p,N,V){return u.render&&u.render(p,N,V),(0,i.jsx)(P,{style:{width:u.width||200},ellipsis:{tooltip:{title:p}},children:u!=null&&u.render?u.render(p,N,V):p})}}):u})})):(0,i.jsx)(Z.ZP,{renderEmpty:function(){return(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)(U.Z,{style:{fontSize:26,margin:"16px 0"}}),(0,i.jsx)("p",{children:"\u6682\u65E0\u6743\u9650"})]})},children:(0,i.jsx)(M.Z,o()(o()({tableLayout:"auto",size:"middle"},z),{},{formItems:[],request:v()(t()().mark(function u(){return t()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",{total:0,success:!1,data:[]});case 1:case"end":return p.stop()}},u)})),toolbarActionConfig:{showReload:!1,showColumnSetting:!1,showDensity:!1,showFullscreen:!1}}))})})};E.Z=O},65571:function($,E,e){var D=e(86378),t=e.n(D),W=e(28488),o=e.n(W),T=e(50959),v=e(79804),A=e(11527),s=["children"],d=function(M){var h=M.children,c=o()(M,s);return(0,A.jsx)(v.Z,t()(t()({style:{height:"calc(100vh - 160px)",overflowY:"auto"}},c),{},{children:h}))};E.Z=d},24898:function($,E,e){var D=e(86378),t=e.n(D),W=e(30577),o=e.n(W),T=e(53690),v=e(84560),A=e(56684),s=e(32499),d=e(50959),_=e(11527),M=function(c){var L=c.popconfirmProps,Z=c.valueName,U=c.SwitchProps,i=c.checked,S=c.loading,P=c.disabled,O=P===void 0?!1:P,I=c.checkedTitle,C=I===void 0?"\u542F\u7528":I,j=c.unCheckedTitle,g=j===void 0?"\u7981\u7528":j,r=c.onConfirm,z=c.editAuth,R=(0,T.useModel)("@@initialState"),F=R.initialState,n=F,K=n.currentUser,le=(0,d.useState)(function(){var u;return z!==void 0?!!(K!=null&&K.authButton&&(u=K.authButton)!==null&&u!==void 0&&u.has(z)):!0}),_e=o()(le,1),re=_e[0];return(0,_.jsx)("div",{children:re?O?(0,_.jsx)(v.Z,t()(t()({unCheckedChildren:g,checkedChildren:C,disabled:O,loading:S},U),{},{checked:i})):(0,_.jsx)(A.Z,t()(t()({placement:"topRight",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",title:(0,_.jsxs)(_.Fragment,{children:["\u60A8\u786E\u5B9A",i?(0,_.jsx)(s.Z,{color:"red",style:{marginLeft:8},children:g}):(0,_.jsx)(s.Z,{color:"success",style:{marginLeft:8},children:C}),(0,_.jsx)(s.Z,{color:"default",children:Z}),"\u5417\uFF1F"]})},L),{},{onConfirm:r,children:(0,_.jsx)(v.Z,t()(t()({unCheckedChildren:g,checkedChildren:C,disabled:O,loading:S},U),{},{checked:i}))})):i?(0,_.jsx)(s.Z,{color:"success",children:C}):(0,_.jsx)(s.Z,{color:"error",children:g})})};E.Z=M},82499:function($,E,e){e.r(E),e.d(E,{default:function(){return ae},updateTreeData:function(){return G}});var D=e(90967),t=e.n(D),W=e(58357),o=e.n(W),T=e(71977),v=e.n(T),A=e(30577),s=e.n(A),d=e(86378),_=e.n(d),M=e(80650),h=e(50959),c=e(28488),L=e.n(c),Z=e(5842),U=e(53801),i=e(6445),S=e(30020),P=e(54098),O=e(43735),I=e(52163),C=e(29675),j=e(80361),g=e(73138),r=e(19708),z=function(l){return(0,r.U2)("/service-sysmgr/auth/OrgController/getOrgChildren",l.query||l)},R=function(l){return(0,r.U2)("/service-sysmgr/auth/OrgController/checkOrgCode",l)},F=function(l){return l.orgId?(0,r.v_)("/service-sysmgr/auth/OrgController/updateOrg",l):(0,r.v_)("/service-sysmgr/auth/OrgController/createOrg",l)},n=e(11527),K=["data","onChange","open","onOpenChange"],le=function B(l){return l.forEach(function(a){a.key=a.orgId,a.title=a.orgName,a.children&&B(a.children)}),l},_e=function(l){var a=l.data,Q=l.onChange,m=l.open,ve=l.onOpenChange,J=L()(l,K),he=O.Z.useForm(),ie=s()(he,1),te=ie[0],pe=(0,U.Z)(F,{manual:!0}),Ee=pe.runAsync,me=(0,U.Z)(R,{manual:!0}),X=me.runAsync,be=function(){var ce=v()(o()().mark(function oe(k){var Y,se;return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(k.orgCode===(a==null?void 0:a.orgCode)){y.next=7;break}return y.next=3,X({orgCode:k.orgCode});case 3:if(Y=y.sent,!(Y.success&&Y.data)){y.next=7;break}return i.ZP.error("\u7EC4\u7EC7\u7F16\u7801\u5DF2\u5B58\u5728\u3001\u8BF7\u4FEE\u6539"),y.abrupt("return",!0);case 7:return y.next=9,Ee(_()(_()({},a),k));case 9:if(se=y.sent,!se.success){y.next=14;break}return i.ZP.success("\u64CD\u4F5C\u6210\u529F"),Q(),y.abrupt("return",se.success);case 14:case"end":return y.stop()}},oe)}));return function(k){return ce.apply(this,arguments)}}();return(0,h.useEffect)(function(){m&&a&&te.setFieldsValue(_()(_()({},a),{},{orgId:{label:a.orgName,value:a.orgId}}))},[m]),(0,n.jsx)(I.Z,_()(_()({open:m,onOpenChange:ve,form:te,width:800,labelCol:{span:6},wrapperCol:{span:16},title:a?"\u4FEE\u6539\u4FE1\u606F":"\u65B0\u5EFA\u7EC4\u7EC7",onFinish:be,modalProps:{afterClose:function(){return te.resetFields()},wrapClassName:"modal_wrap_render"},initialValues:{state:1}},J),{},{children:(0,n.jsxs)(S.Z,{children:[(0,n.jsx)(P.Z,{span:12,children:(0,n.jsx)(C.Z,{name:"sortId",required:!0,label:"\u5E8F\u53F7",min:0,numberProps:{precision:0}})}),(0,n.jsx)(P.Z,{span:12,children:(0,n.jsx)(j.Z,{name:"orgCode",required:!0,label:"\u7EC4\u7EC7\u7F16\u7801"})}),(0,n.jsx)(P.Z,{span:12,children:(0,n.jsx)(j.Z,{name:"orgName",required:!0,label:"\u7EC4\u7EC7\u540D\u79F0"})}),(0,n.jsx)(P.Z,{span:12,children:(0,n.jsx)(Z.Z,{label:"\u72B6\u6001",required:!0,name:"state",propCode:"status"})}),(0,n.jsx)(P.Z,{span:24,children:(0,n.jsx)(g.Z,{labelCol:{span:3},wrapperCol:{span:20},name:"orgDesc",label:"\u7EC4\u7EC7\u63CF\u8FF0"})})]})}))},re=_e,u=e(88536),H=e(35396),p=e(26253),N=e(24898),V=e(4643),de=e(65571),G=function B(l,a,Q){return l.map(function(m){return m.orgId===a?_()(_()({},m),{},{children:Q}):m.children?_()(_()({},m),{},{children:B(m.children,a,Q)}):m})},ne=function(){var l=(0,h.useRef)(),a=(0,h.useRef)(),Q=(0,h.useState)(!1),m=s()(Q,2),ve=m[0],J=m[1],he=(0,h.useState)([]),ie=s()(he,2),te=ie[0],pe=ie[1],Ee=(0,h.useState)(0),me=s()(Ee,2),X=me[0],be=me[1],ce=(0,h.useState)(),oe=s()(ce,2),k=oe[0],Y=oe[1],se=(0,U.Z)(F,{manual:!0,onSuccess:function(f){if(f.success){var b;(b=a.current)===null||b===void 0||b.onSearch()}}}),De=se.runAsync,y=[{title:"\u7EC4\u7EC7\u540D\u79F0",align:"center",dataIndex:"orgName"},{title:"\u7EC4\u7EC7\u7F16\u7801",align:"center",dataIndex:"orgCode"},{align:"center",title:"\u7EC4\u7EC7\u8BF4\u660E",dataIndex:"orgDesc",ellipsis:!0},{title:"\u72B6\u6001",dataIndex:"state",key:"state",align:"center",render:function(f,b){return(0,n.jsx)(N.Z,{checked:f===1,editAuth:"sys:org:update",valueName:b.orgName,onConfirm:v()(o()().mark(function q(){return o()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,De(_()(_()({},b),{},{state:f===1?0:1}));case 2:case"end":return w.stop()}},q)}))})}},{key:"actions",title:"\u64CD\u4F5C",align:"center",fixed:"right",width:150,render:function(f,b){return(0,n.jsxs)(M.Z,{className:"action_bar",children:[(0,n.jsx)(p.Z,{type:"link",auth:"sys:org:create",onClick:function(){Y({parentOrgId:b.orgId,state:1}),J(!0)},children:"\u65B0\u589E\u4E0B\u7EA7"}),(0,n.jsx)(p.Z,{type:"link",auth:"sys:org:update",icon:(0,n.jsx)(H.Z,{}),onClick:function(){Y(_()({},b)),J(!0)},children:"\u4FEE\u6539"})]})}}];return(0,h.useEffect)(function(){var x;(x=a.current)===null||x===void 0||x.onReload()},[X]),(0,n.jsx)(u._z,{children:(0,n.jsxs)(de.Z,{children:[(0,n.jsx)(V.Z,{rowKey:"orgId",auth:"sys:org:list",scroll:{x:1200},toolbarLeft:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Z,{auth:"sys:org:create",type:"primary",onClick:function(){Y(void 0),J(!0)},children:"\u65B0\u589E"})}),tableRef:a,formRef:l,columns:y,pagination:!1,request:v()(o()().mark(function x(){var f,b,q,ue,w;return o()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,z({query:{parentOrgId:X}});case 2:return f=ee.sent,b=f.data,q=f.success,b.forEach(function(Pe){Pe.leaf||(Pe.children=[])}),ue=[],X===0?ue=t()(b):ue=t()(te),w=G(ue,X,b),pe(w),ee.abrupt("return",{total:0,success:q,data:w});case 10:case"end":return ee.stop()}},x)})),onExpand:function(f,b){f&&be(b.orgId)}}),(0,n.jsx)(re,{open:ve,onOpenChange:J,data:k,onChange:function(){var f;(f=a.current)===null||f===void 0||f.onSearch()}})]})})},ae=ne},15663:function($,E,e){e.d(E,{No:function(){return A},Tx:function(){return v},fQ:function(){return T}});var D=e(19708),t=function(d){return post("/service-obs/auth/FileController/fileUpload",d)},W=function(d){return download("/service-obs/auth/FileController/download",{method:"GET",params:d})},o=function(d){return download("/service-obs/auth/ZipFileController/downloadZip",{method:"POST",data:d,fileName:d.fileName})},T=function(d){return(0,D.v_)("/service-sysmgr/auth/PropertyController/pageValue",d)},v=function(d){return(0,D.v_)("/service-league/LeagueController/auth/pageLeague",d)},A=function(d){return(0,D.U2)("/service-league/LeagueController/auth/getPublicOrgChildren",d)}}}]);
